# h4
Tehtävänanto: Moodle, Verkkoon tunkeutuminen. Larin osio.

> 1. Tarkastele käytössäsi olevia RFID tuotteita, mieti miten hyvin olet suojautunut RFID urkinnalta?

Käytössä olevat tuotteet, joita kannan mukana joka päivä:
- Iloq avain, pari LF tagia.
    - Tagit voisivat olla riskialttiita, mutta niitä on aika hankala saada taskusta
    skannattua oikein riittävän nopeasti.
- Puhelin, jossa NFC ominaisuus.
    - Tämäkään ei taida toimia oikein, jos puhelin on lukittuna.
- Nappikuulokkeet, joilla RFID tunnistautuminen kun sitä yhdistetään ensikertaa
puhelimeen.
    - Kotelo kokonaisuudessaan napit sisällä pitäisi saada omiin käsiin, painettua
    pohjassa pairing-nappulaa, jotta lähtisivät hakemaan uutta paria.

---

> 2. Tutustu APDU komentojen rakenteeseen (voit käyttää tekoälyä tutustumiseen)

Application Protocol Data Unit (APDU) [lähde](http://cardlogix.com/glossary/apdu-application-protocol-data-unit-smart-card/).

APDU koostuu joko komennosta (C-APDU) tai vastauksesta (R-APDU).
- C-APDU sisältää:
    - CLA, 1 tavu, komentoluokka
    - INS, 1 tavu, komennon koodi
    - P1, 1 tavu, parametri
    - P2, 1 tavu, parametri
    - Lc, 0,1,3 tavua, lähetettävän datan pituus
    - Data, vaihteleva määrä tavuja
    - Le, 0,1,3 tavua, vastaanotettavan datan pituus

- R-APDU sisältää:
    - Response data, joka voi olla myös tyhjä
    - Sw1, status byte 1
    - Sw2, status byte 2
    - Sw1 ja 2 yhdessä muodostavat palautekoodin. Tämä kertoo:
        - komennon onnistumisesta, 0x9000 -> success
        - onko dataa luettavissa lisää
        - komennon epäonnistumisesta, 0x6a82 -> data object not found esim.

---

> 3. Tutki ja kerro minkä mielenkiintoisen RFID hakkerointi uutiset löysit. (Vinkki, useimmat liittyvät henkilökortteihin)

Lähde: https://blog.quarkslab.com/mifare-classic-static-encrypted-nonce-and-backdoors.html

Tapahtunut vuoden 2024 loppupuolella.

MIFARE Classic FM11RF08S variantilla löytynyt takaovi, jolla kaikki nämä kortit
voidaan korkata muutamassa minuutissa ilman alkuperäistä salausta. Kortit voidaan
siis kloonata ja käyttää sellaisenaan, kunhan oikea laitteisto siihen löytyy.
